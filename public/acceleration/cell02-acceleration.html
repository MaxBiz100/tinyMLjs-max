<!DOCTYPE html>
<html>
<head>
  <title>Accelerometer Data and TensorFlow.js Model</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.6.0/dist/tf.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>  
  
  
  
  
  
  
  
  
</head>
<body>
  <h1>Accelerometer Data and TensorFlow.js Model</h1>
  <div id="output"></div>
  

   <div id="chart"></div>

    <input type="button" value="Graph 1" onclick="btn1Click()">
    <input type="button" value="Graph 2" onclick="btn2Click()">
    <input type="button" value="Graph 3" onclick="btn3Click()">

    <script>
      // Function to generate sinusoidal data
      function myGenerateData(amplitude, frequency) {
        var data = [];
        for (var i = 0; i <= 360; i++) {
          var radians = (i * Math.PI) / 180;
          var y = amplitude * Math.sin(frequency * radians);
          data.push(y);
        }
        return data;
      }

     
     function displayAccelerationData() {
    // Create traces for x, y, and z acceleration data
    const traceX = {
        x: Array.from(Array(accelerationData.length).keys()),
        y: accelerationData.map(data => data[0]),
        mode: 'lines',
        name: 'X',
        line: { color: 'red' },
    };
    
    const traceY = {
        x: Array.from(Array(accelerationData.length).keys()),
        y: accelerationData.map(data => data[1]),
        mode: 'lines',
        name: 'Y',
        line: { color: 'blue' },
    };
    
    const traceZ = {
        x: Array.from(Array(accelerationData.length).keys()),
        y: accelerationData.map(data => data[2]),
        mode: 'lines',
        name: 'Z',
        line: { color: 'green' },
    };
    
    // Define the layout for the chart
    const layout = {
        title: 'Acceleration Data',
        xaxis: {
            title: 'Time (ms)',
        },
        yaxis: {
            title: 'Acceleration (m/s^2)',
        },
    };
    
    // Plot the chart
    Plotly.newPlot('chart', [traceX, traceY, traceZ], layout);
}
 
      
      
      
      
     /* 
      // Function to update the chart with new data
      function myUpdateChart(data1, data2, data3) {
        var trace1 = {
          x: Array.from(Array(361).keys()),
          y: data1,
          mode: 'lines',
          name: 'Line 1',
          line: { color: 'red' },
        };

        var trace2 = {
          x: Array.from(Array(361).keys()),
          y: data2,
          mode: 'lines',
          name: 'Line 2',
          line: { color: 'blue' },
        };

        var trace3 = {
          x: Array.from(Array(361).keys()),
          y: data3,
          mode: 'lines',
          name: 'Line 3',
          line: { color: 'green' },
        };

        var layout = {
          title: 'Sinusoidal Graph',
          xaxis: {
            title: 'Angle (degrees)',
          },
          yaxis: {
            title: 'Value',
          },
        };

        Plotly.newPlot('chart', [trace1, trace2, trace3], layout);
      }

   */   
      
      
      // Button click event handlers
      function btn1Click() {
        var data1 = myGenerateData(6, 1);
        var data2 = myGenerateData(0.5, 2);
        var data3 = myGenerateData(0.2, 3);
        myUpdateChart(data1, data2, data3);
      }

      function btn2Click() {
        var data1 = myGenerateData(2, 1);
        var data2 = myGenerateData(1, 6);
        var data3 = myGenerateData(0.5, 3);
        myUpdateChart(data1, data2, data3);
      }

      function btn3Click() {
        var data1 = myGenerateData(3.5, 1);
        var data2 = myGenerateData(0.2, 2);
        var data3 = myGenerateData(0.6, 3);
        myUpdateChart(data1, data2, data3);
      }
  
  
  
  
  
  
  
  
  


    // TensorFlow model
 //   const model = tf.sequential();
    // Add your model layers here
    // model.add(...);

    // Check if the device supports the DeviceMotion event
    if (window.DeviceMotionEvent) {
      // DeviceMotion event listener
      window.addEventListener('devicemotion', handleMotionEvent);
    } else {
      document.getElementById('output').innerHTML = 'DeviceMotion not supported.';
    }

    let accelerometerData = [];
    let startTime = null;

    // Event handler for DeviceMotion event
    function handleMotionEvent(event) {
      const acceleration = event.acceleration;
      const x = acceleration.x;
      const y = acceleration.y;
      const z = acceleration.z;

      // Start collecting data if startTime is null
      if (startTime === null) {
        startTime = performance.now();
      }

      // Calculate elapsed time in milliseconds
      const elapsedTime = performance.now() - startTime;

      // Collect accelerometer data for 500 ms
      if (elapsedTime < 500) {
        accelerometerData.push([x, y, z]);
      } else {
        // Preprocess the collected accelerometer data and use it for inference with TensorFlow.js
        const input = tf.tensor2d(accelerometerData);
     //   const prediction = model.predict(input);
     //   const predictedLabel = prediction.dataSync()[0];
      //  const result = predictedLabel === 0 ? 'punch' : 'get up';

      //  document.getElementById('output').innerHTML = `<p>Prediction: ${result}</p>`;
        document.getElementById('output').innerHTML = `<p>accelerometerData: ${accelerometerData}</p>`;

        // Reset variables for the next data collection
        accelerometerData = [];
        startTime = null;
        displayAccelerationData()
      }
    }
  </script>
</body>
</html>
